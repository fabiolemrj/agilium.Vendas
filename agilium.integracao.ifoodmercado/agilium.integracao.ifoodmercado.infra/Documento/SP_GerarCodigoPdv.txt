CREATE DEFINER=`root`@`localhost` PROCEDURE `GeraCodigoPDV`()
BEGIN 
	declare v_codigo int;
	 SELECT MAX(CAST(CDPDV AS UNSIGNED)) AS CD into v_codigo  FROM pdv ;
   
	if(v_codigo is null) then   
		set v_codigo := 1;
	else
		set v_codigo  := v_codigo + 1;
	end if;
   
    select v_codigo ;
END